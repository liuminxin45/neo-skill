{
  "version": 1,
  "name": "skill-creator",
  "description": "对话式收集需求（最多 10 问），生成 Windsurf workflow（主要目标）+ Claude/Cursor/GitHub Skills 兼容输出。支持多级数据索引、共享资源架构、Master+Overrides 模式。",
  "primary_target": "windsurf",
  "backward_compat": ["claude", "cursor", "github"],
  "questions": [
    "这个 skill 的一句话目标是什么（动词开头，面向可重复任务）？",
    "用户会用哪些触发语句/关键词来表述这个需求（至少 5 条）？",
    "期望输出是什么形态（报告/代码/补丁/命令/文件树/清单等）？",
    "硬约束有哪些（例如不可改变行为/不可联网/必须跑测试等）？",
    "允许使用的工具边界是什么（shell/git/python/读写文件/网络等）？",
    "需要哪些输入（repo/commit/diff/config/logs 等），从哪里来？",
    "工作流要拆成哪些关键步骤/分支？关键 gate 是什么？",
    "常见失败/边界情况有哪些？希望如何处理（停止/回退/提示）？",
    "哪些内容应放到 references/（规则）、assets/（数据）、scripts/（确定性执行）或 .shared/（跨skill复用）？"
  ],
  "triggers": [
    "我想做一个 skill",
    "帮我生成 Windsurf workflow",
    "帮我生成 SKILL.md",
    "把我的 prompt 工作流变成 skill",
    "帮我在已有 skill 的基础上补充/重构 workflow steps",
    "做一个 skill 库/skill creator",
    "打包成 Claude .skill",
    "create a new skill",
    "generate workflow for my task"
  ],
  "freedom_level": "low",
  "workflow": {
    "type": "sequential",
    "steps": [
      {
        "id": "analyze",
        "title": "分析用户需求",
        "kind": "action",
        "commands": [],
        "notes": "提取关键信息：任务类型、输出形态、约束条件、工具边界。\n\n重要：在进入详细提问之前，必须优先检查是否已有高置信度第三方 skill 可用（通过 skill-finder）。可用搜索辅助：`python3 .shared/skill-creator/scripts/search.py \"<keywords>\" --skill-system`"
      },
      {
        "id": "third-party-recommend",
        "title": "优先推荐第三方 skill（skill-finder）",
        "kind": "gate",
        "commands": [
          "python -m skill_finder.cli match --goal \"<user_request>\" --ide <ide> --format json --min-score 0.7"
        ],
        "notes": "规则：skill-creator 创建前必须先从第三方 registry 推荐。\n\n执行：用用户的原始请求作为 goal（<user_request>），调用 skill-finder 进行高置信匹配（min-score=0.7），并读取 JSON 输出。\n\n- 若命中（matches 非空）：\n  1) 展示 Top1 推荐（unit + package + score + README + 安装方式摘要）\n  2) 明确询问二次确认：是否安装该第三方 skill（y/n）\n  3) 若用户选择安装：输出 package.install.auto_install_cmd / manual_install_cmd，并建议用户转到 /skill-finder 完成安装与记录；本次不再继续创建 skill\n  4) 若用户拒绝安装：继续进入后续创建流程\n\n- 若未命中：直接进入后续创建流程\n\n注意：不得臆测“registry/索引缺失”；只基于命令返回的 JSON 做结论。"
      },
      {
        "id": "collect",
        "title": "对话式收集需求（<=10 问）",
        "kind": "action",
        "commands": [],
        "notes": "只问缺失信息；最多 10 个问题；优先级：目标 > 触发词 > 输出形态 > 约束 > 工具边界。详见 `references/requirement-collection.md`"
      },
      {
        "id": "design",
        "title": "设计 Skill 系统（Master + Overrides）",
        "kind": "action",
        "commands": [
          "python3 .shared/skill-creator/scripts/search.py \"<task_keywords>\" --skill-system -p \"<skill_name>\""
        ],
        "notes": "生成完整设计：workflow pattern + output pattern + resource strategy + reasoning rules。详见 `references/skill-system-design.md`"
      },
      {
        "id": "spec",
        "title": "落地 SkillSpec（单一真源）",
        "kind": "action",
        "commands": [],
        "notes": "写入 skills/<name>/skillspec.json；采用索引式 notes（指向 references/）；确定 references/scripts/assets/.shared 分布。"
      },
      {
        "id": "edit-workflow",
        "title": "补充/重构 workflow steps",
        "kind": "action",
        "commands": [],
        "notes": "更新已有 skill 时：读取现有 spec → 归类新需求到已有 step → 必要时新增/合并 step → 输出变更摘要。协议见 `references/workflow-step-editing.md`"
      },
      {
        "id": "generate",
        "title": "生成 Windsurf workflow（+ 兼容输出）",
        "kind": "action",
        "commands": [
          "python3 .shared/skill-creator/scripts/generate.py skills/<skill>/skillspec.json",
          "python3 .shared/skill-creator/scripts/generate.py skills/<skill>/skillspec.json --all"
        ],
        "notes": "默认只生成 Windsurf；--all 生成全部兼容目标（Claude/Cursor/GitHub）。"
      },
      {
        "id": "validate",
        "title": "校验（spec + outputs + 结构）",
        "kind": "gate",
        "commands": [
          "python3 .shared/skill-creator/scripts/validate.py skills/<skill>/skillspec.json"
        ],
        "notes": "检查：kebab-case 命名、questions<=10、Claude frontmatter strict、无 banned files。详见 `.shared/skill-creator/data/validation-rules.csv`"
      },
      {
        "id": "checklist",
        "title": "Pre-delivery Checklist",
        "kind": "gate",
        "commands": [],
        "notes": "交付前检查：triggers 覆盖常见表述、workflow steps 完整、references 无冗余、scripts 可执行。详见 `references/pre-delivery-checklist.md`"
      },
      {
        "id": "package",
        "title": "打包分发",
        "kind": "action",
        "commands": [
          "python3 .shared/skill-creator/scripts/package.py --target claude --skill <skill>"
        ],
        "notes": "Claude .skill zip（根是 skill 文件夹）；可选 --target repo 打包整个仓库。"
      }
    ]
  },
  "references": [
    "references/output-patterns.md",
    "references/workflows.md",
    "references/workflow-step-editing.md",
    "references/requirement-collection.md",
    "references/skill-system-design.md",
    "references/pre-delivery-checklist.md"
  ],
  "scripts": [],
  "assets": []
}
